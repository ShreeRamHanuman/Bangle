<html>
<head>
  <title>Heart Rate from Bangle.js</title>
</head>
<body>
  <script src="https://www.espruino.com/js/uart.js"></script>
  <script>
    
var currentBPM = null;
var currentConfidence = null;

     var BANGLE_CODE = `
  Bangle.setHRMPower(1)
  Bangle.on('HRM',function(hrm) {
    var d = [
      "H",
      hrm.bpm,
      hrm.confidence
      ];
    Bluetooth.println(d.join(","));
  })
  `;
function getHealthHeart() {

          // Now upload our code to it
          UART.eval("\x03\x10if(1){"+BANGLE_CODE+"}\n",
            function() { console.log("Ready..."); });
  }
  

setInterval(getHealthHeart, 3000);


  </script>

  <h1>Health Status 109</h1><button onclick="getHealthHeart()">Get Heart Rate</button>
</body>
</html>
