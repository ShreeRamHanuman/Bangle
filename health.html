<html>
<head>
  <title>Heart Rate from Bangle.js</title>
</head>
<body>
  <script src="https://www.espruino.com/js/uart.js"></script>
  <script>
    
    // Enable the heart rate sensor on Bangle.js
    UART.eval('Bangle.setHRMPower(1)', function(result) {
      console.log("Heart rate monitor powered on:", result);
    });
var  bpm = 0;
    var confidence = 0;
    function getHealthHeart() {
  
      // Fetch heart rate using UART.eval
     UART.eval(`Bangle.on('HRM')`, function(heartRateData) {
     const parsedData = JSON.parse(heartRateData);
      bpm = parsedData.bpm;
console.log("Heart Rate (BPM):", bpm);

// Access the confidence level
 confidence = parsedData.confidence;
console.log("Confidence:", confidence, "%");

// Convert the raw Uint8Array data into an array
const rawSamples = new Uint8Array(parsedData.raw);
console.log("Raw Samples (Uint8Array):", rawSamples);
     });}
    // Fetch heart rate every 10 seconds
    setInterval(getHealthHeart, 1000);
  </script>

  <h1>Health Status 109</h1>
  <button onclick="getHealthHeart()">Get Heart Rate</button>
  <br><br>


</body>
</html>
